# 小米手机APK安装问题解决指南

## 问题现象
在小米手机上安装APK时出现"解析软件包时出现问题，packageInfo is null"错误。

## 常见原因及解决方案

### 1. APK签名问题
**原因**：未签名或签名不正确的APK包
**解决方案**：
- ✅ 已在GitHub Actions中添加调试签名
- ✅ 配置了signingConfig确保APK正确签名

### 2. AndroidManifest.xml配置问题
**解决方案**：
- ✅ 添加了`android:versionCode`和`android:versionName`
- ✅ 添加了`uses-sdk`配置
- ✅ 指定了正确的Application名称
- ✅ 配置了`android:installLocation="auto"`

### 3. 小米MIUI特殊要求
**解决方案**：
- ✅ 添加了`android:extractNativeLibs="true"`
- ✅ 配置了FileProvider
- ✅ 添加了file_paths.xml配置文件

### 4. 小米手机安装步骤

#### 步骤1：开启安装权限
1. 打开**设置** → **隐私保护** → **特殊应用权限**
2. 选择**安装未知应用**
3. 找到你要用来安装APK的应用（如浏览器、文件管理器）
4. 开启**允许安装未知应用**权限

#### 步骤2：关闭MIUI优化（临时）
1. 打开**设置** → **更多设置** → **开发者选项**
2. 找到**MIUI优化**选项
3. 临时关闭MIUI优化
4. 重启手机

#### 步骤3：安装APK
1. 下载APK文件到手机
2. 使用文件管理器打开APK文件
3. 点击安装
4. 如果提示安全风险，选择**仍要安装**

#### 步骤4：重新开启MIUI优化
安装成功后，可以重新开启MIUI优化。

### 5. 替代安装方法

#### 方法1：使用ADB安装
```bash
# 电脑上执行
adb install yansd-music-v1.0.0.apk
```

#### 方法2：通过小米应用商店
1. 将APK文件重命名为`.zip`
2. 解压后重新打包
3. 或者通过小米开发者账号上传

### 6. 故障排除

#### 如果仍然无法安装：
1. **清理缓存**：设置 → 应用管理 → 包安装程序 → 清除缓存
2. **重启手机**：完全重启设备
3. **尝试不同的安装程序**：使用ES文件浏览器等第三方应用
4. **检查存储空间**：确保有足够的存储空间
5. **检查APK完整性**：重新下载APK文件

#### 安装成功后的配置：
1. **自启动管理**：设置 → 应用设置 → 授权管理 → 自启动管理 → 开启YanSD Music
2. **省电策略**：设置 → 应用设置 → 应用管理 → YanSD Music → 省电策略 → 无限制
3. **网络权限**：确保应用有网络访问权限
4. **存储权限**：授予必要的存储权限

## 技术改进

当前版本已实现的优化：
- ✅ 添加了APK调试签名
- ✅ 优化了AndroidManifest.xml配置
- ✅ 添加了小米手机兼容性配置
- ✅ 配置了FileProvider支持
- ✅ 添加了网络安全配置

## 联系支持

如果按照以上步骤仍无法解决问题，请：
1. 提供具体的错误信息截图
2. 说明小米手机型号和MIUI版本
3. 描述安装过程中的具体步骤

---
*最后更新：2025年7月26日*
